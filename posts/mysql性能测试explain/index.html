<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">

        <title>mysql的explain关键字</title>

        <link rel="stylesheet" href="/css/stylesheet.css">
    </head>
    <body>
        <section id="page-title">
            <h1><a href="/">nber1994</a></h1>
        </section>



<section class="blog-post">
    <h1>mysql的explain关键字</h1>
    <div class="blog-post-subheader">
        October 27, 2017
    </div>
    <div class="blog-post-content">
        <blockquote>
<p>胡乱的记录了一些explain关键字的一些用法,以及相关的评判参数</p>
</blockquote>
<h1 id="explain概述">explain概述</h1>
<p>EXPLAIN关键字一般放在SELECT查询语句的前面，用于描述MySQL如何执行查询操作、以及MySQL成功返回结果集需要执行的行数。explain 可以帮助我们分析 select 语句,让我们知道查询效率低下的原因,从而改进我们查询,让查询优化器能够更好的工作。</p>
<h1 id="how-to-work">how to work</h1>
<p>MySQL 查询优化器有几个目标,但是其中最主要的目标是尽可能地使用索引,并且使用最严格的索引来消除尽可能多的数据行。最终目标是提交 SELECT 语句查找数据行,而不是排除数据行。优化器试图排除数据行的原因在于它排除数据行的速度越快,那么找到与条件匹配的数据行也就越快。如果能够首先进行最严格的测试,查询就可以执行地更快。</p>
<h1 id="explain的各个参数的详解">explain的各个参数的详解</h1>
<h2 id="id">id</h2>
<table>
<thead>
<tr>
<th>项目</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>MySQL Query Optimizer 选定的执行计划中查询的序列号。表示查询中执行 select 子句或操作表的顺序,id 值越大优先级越高,越先被执行。id 相同,执行顺序由上至下</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"> <span style="color:#f92672">**</span>id<span style="color:#f92672">**</span>SQL执行的顺利的标识,SQL从大到小的执行.

<span style="color:#960050;background-color:#1e0010">例如</span>:
mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> (<span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> ( <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t3 <span style="color:#66d9ef">where</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">3952602</span>) a) b;
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> select_type <span style="color:#f92672">|</span> <span style="color:#66d9ef">table</span>      <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span>   <span style="color:#f92672">|</span> possible_keys     <span style="color:#f92672">|</span> <span style="color:#66d9ef">key</span>     <span style="color:#f92672">|</span> key_len <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>  <span style="color:#f92672">|</span> <span style="color:#66d9ef">rows</span> <span style="color:#f92672">|</span> Extra <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>     <span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span>derived2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">system</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>              <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>  <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span> DERIVED     <span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span>derived3<span style="color:#f92672">&gt;</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">system</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>              <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>  <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span> DERIVED     <span style="color:#f92672">|</span> t3         <span style="color:#f92672">|</span> const  <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span>      <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+
</span><span style="color:#75715e"></span>
<span style="color:#960050;background-color:#1e0010">很显然这条</span>SQL是从里向外的执行,<span style="color:#960050;background-color:#1e0010">就是从</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> <span style="color:#960050;background-color:#1e0010">向上执行</span>.
</code></pre></div><h2 id="select_type">select_type</h2>
<h3 id="select_type-simple">select_type-SIMPLE</h3>
<p><strong>首先是select__type:将select查询分为简单(simple)和复杂两种类型复杂类型又分为子查询(subquery)和from列表中包含子查询(drived)</strong></p>
<table>
<thead>
<tr>
<th>select_type 查询类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>SIMPLE</td>
<td>简单的 select 查询,不使用 union 及子查询</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">简单</span><span style="color:#66d9ef">SELECT</span>(<span style="color:#960050;background-color:#1e0010">不使用</span>UNION或子查询等) <span style="color:#960050;background-color:#1e0010">例如</span>:
mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t3 <span style="color:#66d9ef">where</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">3952602</span>;
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> select_type <span style="color:#f92672">|</span> <span style="color:#66d9ef">table</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span>  <span style="color:#f92672">|</span> possible_keys     <span style="color:#f92672">|</span> <span style="color:#66d9ef">key</span>     <span style="color:#f92672">|</span> key_len <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>   <span style="color:#f92672">|</span> <span style="color:#66d9ef">rows</span> <span style="color:#f92672">|</span> Extra <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">SIMPLE</span>      <span style="color:#f92672">|</span> t3    <span style="color:#f92672">|</span> const <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span> const <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------+
</span></code></pre></div><h3 id="select_type-peimary">select_type-PEIMARY</h3>
<table>
<thead>
<tr>
<th>select_type 查询类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>PRIMARY</td>
<td>最外层的 select 查询</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> (<span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t3 <span style="color:#66d9ef">where</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">3952602</span>) a ;
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> select_type <span style="color:#f92672">|</span> <span style="color:#66d9ef">table</span>      <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span>   <span style="color:#f92672">|</span> possible_keys     <span style="color:#f92672">|</span> <span style="color:#66d9ef">key</span>     <span style="color:#f92672">|</span> key_len <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>  <span style="color:#f92672">|</span> <span style="color:#66d9ef">rows</span> <span style="color:#f92672">|</span> Extra <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>     <span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span>derived2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">system</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>              <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>  <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span> DERIVED     <span style="color:#f92672">|</span> t3         <span style="color:#f92672">|</span> const  <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span>      <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+
</span></code></pre></div><h3 id="select_type-union">select_type-UNION</h3>
<table>
<thead>
<tr>
<th>select_type 查询类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>UNION</td>
<td>UNION 中的第二个或随后的 select 查询,不依赖于外部查询的结果集</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">UNION中的第二个或后面的SELECT语句.<span style="color:#960050;background-color:#1e0010">例如</span>
mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t3 <span style="color:#66d9ef">where</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">3952602</span> <span style="color:#66d9ef">union</span> <span style="color:#66d9ef">all</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t3 ;
<span style="color:#f92672">+</span><span style="color:#75715e">----+--------------+------------+-------+-------------------+---------+---------+-------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> select_type  <span style="color:#f92672">|</span> <span style="color:#66d9ef">table</span>      <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span>  <span style="color:#f92672">|</span> possible_keys     <span style="color:#f92672">|</span> <span style="color:#66d9ef">key</span>     <span style="color:#f92672">|</span> key_len <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>   <span style="color:#f92672">|</span> <span style="color:#66d9ef">rows</span> <span style="color:#f92672">|</span> Extra <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+--------------+------------+-------+-------------------+---------+---------+-------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>      <span style="color:#f92672">|</span> t3         <span style="color:#f92672">|</span> const <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span> const <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>  <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">UNION</span>        <span style="color:#f92672">|</span> t3         <span style="color:#f92672">|</span> <span style="color:#66d9ef">ALL</span>   <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>              <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>  <span style="color:#f92672">|</span> <span style="color:#ae81ff">1000</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span><span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">UNION</span> <span style="color:#66d9ef">RESULT</span> <span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span>union1,<span style="color:#ae81ff">2</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">ALL</span>   <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>              <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>  <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+--------------+------------+-------+-------------------+---------+---------+-------+------+-------+
</span></code></pre></div><h3 id="select_type-dependent-union">select_type-DEPENDENT UNION</h3>
<table>
<thead>
<tr>
<th>select_type 查询类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>DEPENDENT UNION</td>
<td>UNION 中的第二个或随后的 select 查询,依 赖于外部查询的结果集</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">UNION中的第二个或后面的SELECT语句<span style="color:#960050;background-color:#1e0010">，取决于外面的查询</span>

mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t3 <span style="color:#66d9ef">where</span> id <span style="color:#66d9ef">in</span> (<span style="color:#66d9ef">select</span> id <span style="color:#66d9ef">from</span> t3 <span style="color:#66d9ef">where</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">3952602</span> <span style="color:#66d9ef">union</span> <span style="color:#66d9ef">all</span> <span style="color:#66d9ef">select</span> id <span style="color:#66d9ef">from</span> t3)  ;
<span style="color:#f92672">+</span><span style="color:#75715e">----+--------------------+------------+--------+-------------------+---------+---------+-------+------+--------------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> select_type        <span style="color:#f92672">|</span> <span style="color:#66d9ef">table</span>      <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span>   <span style="color:#f92672">|</span> possible_keys     <span style="color:#f92672">|</span> <span style="color:#66d9ef">key</span>     <span style="color:#f92672">|</span> key_len <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>   <span style="color:#f92672">|</span> <span style="color:#66d9ef">rows</span> <span style="color:#f92672">|</span> Extra                    <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+--------------------+------------+--------+-------------------+---------+---------+-------+------+--------------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>            <span style="color:#f92672">|</span> t3         <span style="color:#f92672">|</span> <span style="color:#66d9ef">ALL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>              <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>  <span style="color:#f92672">|</span> <span style="color:#ae81ff">1000</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">Using</span> <span style="color:#66d9ef">where</span>              <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>  <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span> DEPENDENT SUBQUERY <span style="color:#f92672">|</span> t3         <span style="color:#f92672">|</span> const  <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span> const <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">Using</span> <span style="color:#66d9ef">index</span>              <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>  <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span> DEPENDENT <span style="color:#66d9ef">UNION</span>    <span style="color:#f92672">|</span> t3         <span style="color:#f92672">|</span> eq_ref <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span> func  <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">Using</span> <span style="color:#66d9ef">where</span>; <span style="color:#66d9ef">Using</span> <span style="color:#66d9ef">index</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span><span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">UNION</span> <span style="color:#66d9ef">RESULT</span>       <span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span>union2,<span style="color:#ae81ff">3</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">ALL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>              <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>  <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span>                          <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+--------------------+------------+--------+-------------------+---------+---------+-------+------+--------------------------+
</span></code></pre></div><h3 id="select_type-subquery">select_type-SUBQUERY</h3>
<table>
<thead>
<tr>
<th>select_type 查询类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>SUBQUERY</td>
<td>子查询中的第一个 select 查询,不依赖于外 部查询的结果集</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">子查询中的第一个</span><span style="color:#66d9ef">SELECT</span>.

mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t3 <span style="color:#66d9ef">where</span> id <span style="color:#f92672">=</span> (<span style="color:#66d9ef">select</span> id <span style="color:#66d9ef">from</span> t3 <span style="color:#66d9ef">where</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">3952602</span> )  ;
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> select_type <span style="color:#f92672">|</span> <span style="color:#66d9ef">table</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span>  <span style="color:#f92672">|</span> possible_keys     <span style="color:#f92672">|</span> <span style="color:#66d9ef">key</span>     <span style="color:#f92672">|</span> key_len <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>   <span style="color:#f92672">|</span> <span style="color:#66d9ef">rows</span> <span style="color:#f92672">|</span> Extra       <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>     <span style="color:#f92672">|</span> t3    <span style="color:#f92672">|</span> const <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span> const <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>             <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>  <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span> SUBQUERY    <span style="color:#f92672">|</span> t3    <span style="color:#f92672">|</span> const <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">Using</span> <span style="color:#66d9ef">index</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------------+
</span></code></pre></div><h3 id="select_type-dependent-subquery">select_type-DEPENDENT SUBQUERY</h3>
<table>
<thead>
<tr>
<th>select_type 查询类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>DEPENDENT SUBQUERY</td>
<td>子查询中的第一个 select 查询,依赖于外部 查询的结果集</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">子查询中的第一个</span><span style="color:#66d9ef">SELECT</span><span style="color:#960050;background-color:#1e0010">，取决于外面的查询</span>

mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> id <span style="color:#66d9ef">from</span> t3 <span style="color:#66d9ef">where</span> id <span style="color:#66d9ef">in</span> (<span style="color:#66d9ef">select</span> id <span style="color:#66d9ef">from</span> t3 <span style="color:#66d9ef">where</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">3952602</span> )  ;
<span style="color:#f92672">+</span><span style="color:#75715e">----+--------------------+-------+-------+-------------------+---------+---------+-------+------+--------------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> select_type        <span style="color:#f92672">|</span> <span style="color:#66d9ef">table</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span>  <span style="color:#f92672">|</span> possible_keys     <span style="color:#f92672">|</span> <span style="color:#66d9ef">key</span>     <span style="color:#f92672">|</span> key_len <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>   <span style="color:#f92672">|</span> <span style="color:#66d9ef">rows</span> <span style="color:#f92672">|</span> Extra                    <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+--------------------+-------+-------+-------------------+---------+---------+-------+------+--------------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>            <span style="color:#f92672">|</span> t3    <span style="color:#f92672">|</span> <span style="color:#66d9ef">index</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>              <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>  <span style="color:#f92672">|</span> <span style="color:#ae81ff">1000</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">Using</span> <span style="color:#66d9ef">where</span>; <span style="color:#66d9ef">Using</span> <span style="color:#66d9ef">index</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>  <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span> DEPENDENT SUBQUERY <span style="color:#f92672">|</span> t3    <span style="color:#f92672">|</span> const <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span> const <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">Using</span> <span style="color:#66d9ef">index</span>              <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+--------------------+-------+-------+-------------------+---------+---------+-------+------+--------------------------+
</span></code></pre></div><h3 id="select_type-derived">select_type-DERIVED</h3>
<table>
<thead>
<tr>
<th>select_type 查询类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>DERIVED</td>
<td>用于 from 子句里有子查询的情况,MySQL会递归执行这些子查询, 把结果放在临时表里</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">派生表的</span><span style="color:#66d9ef">SELECT</span>(FROM子句的子查询)

mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> (<span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t3 <span style="color:#66d9ef">where</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">3952602</span>) a ;
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> select_type <span style="color:#f92672">|</span> <span style="color:#66d9ef">table</span>      <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span>   <span style="color:#f92672">|</span> possible_keys     <span style="color:#f92672">|</span> <span style="color:#66d9ef">key</span>     <span style="color:#f92672">|</span> key_len <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>  <span style="color:#f92672">|</span> <span style="color:#66d9ef">rows</span> <span style="color:#f92672">|</span> Extra <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>     <span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span>derived2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">system</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>              <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>  <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span> DERIVED     <span style="color:#f92672">|</span> t3         <span style="color:#f92672">|</span> const  <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span>      <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+
</span></code></pre></div><h3 id="select_type-uncacheable-subquery">select_type-UNCACHEABLE SUBQUERY</h3>
<table>
<thead>
<tr>
<th>select_type 查询类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>UNCACHEABLE SUBQUERY</td>
<td>结果集不能被缓存的子查询,必须重新为外 层查询的每一行进行评估</td>
</tr>
</tbody>
</table>
<h3 id="select_type-uncacheable-union">select_type-UNCACHEABLE UNION</h3>
<table>
<thead>
<tr>
<th>select_type 查询类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>UNCACHEABLE UNION</td>
<td>UNION 中的第二个或随后的 select 查询,属 于不可缓存的子查询</td>
</tr>
</tbody>
</table>
<h2 id="table">table</h2>
<table>
<thead>
<tr>
<th>项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>table</td>
<td>输出引用到的表</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">显示这一行的数据是关于哪张表的</span>.
<span style="color:#960050;background-color:#1e0010">有时不是真实的表名字</span>,<span style="color:#960050;background-color:#1e0010">看到的是</span>derivedx(x是个数字,<span style="color:#960050;background-color:#1e0010">可以理解为是第几步执行的结果</span>)

mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> (<span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> ( <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t3 <span style="color:#66d9ef">where</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">3952602</span>) a) b;
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> select_type <span style="color:#f92672">|</span> <span style="color:#66d9ef">table</span>      <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span>   <span style="color:#f92672">|</span> possible_keys     <span style="color:#f92672">|</span> <span style="color:#66d9ef">key</span>     <span style="color:#f92672">|</span> key_len <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>  <span style="color:#f92672">|</span> <span style="color:#66d9ef">rows</span> <span style="color:#f92672">|</span> Extra <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>     <span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span>derived2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">system</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>              <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>  <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span> DERIVED     <span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span>derived3<span style="color:#f92672">&gt;</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">system</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>              <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>  <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span> DERIVED     <span style="color:#f92672">|</span> t3         <span style="color:#f92672">|</span> const  <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span>      <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+
</span></code></pre></div><h2 id="type">type</h2>
<p><strong>这列很重要,显示了连接使用了哪种类别,有无使用索引</strong>
<strong>从最好到最差的连接类型为const、eq__reg、ref、range、indexhe和ALL</strong></p>
<h3 id="type-system">type-system</h3>
<table>
<thead>
<tr>
<th>type 重要的项,显示连接使用的类型,按最 优到最差的类型排序</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>system</td>
<td>表仅有一行(=系统表)。这是 const 连接类型的一个特例</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">这是</span>const联接类型的一个特例<span style="color:#960050;background-color:#1e0010">。表仅有一行满足条件</span>.<span style="color:#960050;background-color:#1e0010">如下</span>(t3表上的id是 <span style="color:#66d9ef">primary</span> <span style="color:#66d9ef">key</span>)

mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> (<span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t3 <span style="color:#66d9ef">where</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">3952602</span>) a ;
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> select_type <span style="color:#f92672">|</span> <span style="color:#66d9ef">table</span>      <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span>   <span style="color:#f92672">|</span> possible_keys     <span style="color:#f92672">|</span> <span style="color:#66d9ef">key</span>     <span style="color:#f92672">|</span> key_len <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>  <span style="color:#f92672">|</span> <span style="color:#66d9ef">rows</span> <span style="color:#f92672">|</span> Extra <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>     <span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span>derived2<span style="color:#f92672">&gt;</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">system</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>              <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>  <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span> DERIVED     <span style="color:#f92672">|</span> t3         <span style="color:#f92672">|</span> const  <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span>      <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+
</span></code></pre></div><h3 id="type-const">type-const</h3>
<table>
<thead>
<tr>
<th>type 重要的项,显示连接使用的类型,按最 优到最差的类型排序</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>const</td>
<td>const 用于用常数值比较 PRIMARY KEY 时。当查询的表仅有一行时,使用 System, <strong>说明索引一次就找到了,最多只会有一条匹配的行</strong></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">表最多有一个匹配行，它将在查询开始时被读取。因为仅有一行，在这行的列值可被优化器剩余部分认为是常数。</span>const表很快<span style="color:#960050;background-color:#1e0010">，因为它们只读取一次！</span>

const用于用常数值比较PRIMARY KEY或UNIQUE索引的所有部分时<span style="color:#960050;background-color:#1e0010">。在下面的查询中，</span>tbl_name可以用于const表<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> tbl_name <span style="color:#66d9ef">WHERE</span> primary_key<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">；</span>
<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> tbl_name <span style="color:#66d9ef">WHERE</span> primary_key_part1<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">和</span> primary_key_part2<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span><span style="color:#960050;background-color:#1e0010">；</span>

<span style="color:#960050;background-color:#1e0010">例如</span>:
mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t3 <span style="color:#66d9ef">where</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">3952602</span>;
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> select_type <span style="color:#f92672">|</span> <span style="color:#66d9ef">table</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span>  <span style="color:#f92672">|</span> possible_keys     <span style="color:#f92672">|</span> <span style="color:#66d9ef">key</span>     <span style="color:#f92672">|</span> key_len <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>   <span style="color:#f92672">|</span> <span style="color:#66d9ef">rows</span> <span style="color:#f92672">|</span> Extra <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">SIMPLE</span>      <span style="color:#f92672">|</span> t3    <span style="color:#f92672">|</span> const <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span> const <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------+
</span></code></pre></div><h3 id="type-eq_ref">type-eq_ref</h3>
<table>
<thead>
<tr>
<th>type 重要的项,显示连接使用的类型,按最 优到最差的类型排序</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>eq_ref</td>
<td>const 用于用常数值比较 PRIMARY KEY 时。当查询的表仅有一行时,使用 System,<strong>使用唯一索引查找(主键或唯一索引)</strong></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">对于每个来自于前面的表的行组合，从该表中读取一行。这可能是最好的联接类型，除了</span>const类型<span style="color:#960050;background-color:#1e0010">。它用在一个索引的所有部分被联接使用并且索引是</span>UNIQUE或PRIMARY <span style="color:#66d9ef">KEY</span><span style="color:#960050;background-color:#1e0010">。</span>

eq_ref可以用于使用<span style="color:#f92672">=</span> <span style="color:#960050;background-color:#1e0010">操作符比较的带索引的列。比较值可以为常量或一个使用在该表前面所读取的表的列的表达式。</span>

<span style="color:#960050;background-color:#1e0010">在下面的例子中，</span>MySQL可以使用eq_ref联接来处理ref_tables<span style="color:#960050;background-color:#1e0010">：</span>

<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> ref_table,other_table
  <span style="color:#66d9ef">WHERE</span> ref_table.key_column<span style="color:#f92672">=</span>other_table.<span style="color:#66d9ef">column</span>;

<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> ref_table,other_table
  <span style="color:#66d9ef">WHERE</span> ref_table.key_column_part1<span style="color:#f92672">=</span>other_table.<span style="color:#66d9ef">column</span>
    <span style="color:#66d9ef">AND</span> ref_table.key_column_part2<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;

<span style="color:#960050;background-color:#1e0010">例如</span>
mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">create</span> <span style="color:#66d9ef">unique</span> <span style="color:#66d9ef">index</span>  idx_t3_id <span style="color:#66d9ef">on</span> t3(id) ;
Query OK, <span style="color:#ae81ff">1000</span> <span style="color:#66d9ef">rows</span> affected (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">03</span> sec)
Records: <span style="color:#ae81ff">1000</span>  Duplicates: <span style="color:#ae81ff">0</span>  Warnings: <span style="color:#ae81ff">0</span>

mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t3,t4 <span style="color:#66d9ef">where</span> t3.id<span style="color:#f92672">=</span>t4.accountid;
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+--------+-------------------+-----------+---------+----------------------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> select_type <span style="color:#f92672">|</span> <span style="color:#66d9ef">table</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span>   <span style="color:#f92672">|</span> possible_keys     <span style="color:#f92672">|</span> <span style="color:#66d9ef">key</span>       <span style="color:#f92672">|</span> key_len <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>                  <span style="color:#f92672">|</span> <span style="color:#66d9ef">rows</span> <span style="color:#f92672">|</span> Extra <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+--------+-------------------+-----------+---------+----------------------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">SIMPLE</span>      <span style="color:#f92672">|</span> t4    <span style="color:#f92672">|</span> <span style="color:#66d9ef">ALL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>              <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>      <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>                 <span style="color:#f92672">|</span> <span style="color:#ae81ff">1000</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">SIMPLE</span>      <span style="color:#f92672">|</span> t3    <span style="color:#f92672">|</span> eq_ref <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> idx_t3_id <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span> dbatest.t4.accountid <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+--------+-------------------+-----------+---------+----------------------+------+-------+
</span></code></pre></div><h3 id="type-ref">type-ref</h3>
<table>
<thead>
<tr>
<th>type 重要的项,显示连接使用的类型,按最 优到最差的类型排序</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ref</td>
<td>连接不能基于关键字选择单个行,可能查找 到多个符合条件的行。 叫做 ref 是因为索引要 跟某个参考值相比较。这个参考值或者是一 个常数,或者是来自一个表里的多表查询的 结果值,<strong>多个匹配,非唯一索引访问(只有普通索引)</strong></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">对于每个来自于前面的表的行组合，所有有匹配索引值的行将从这张表中读取。如果联接只使用键的最左边的前缀，或如果键不是</span>UNIQUE或PRIMARY <span style="color:#66d9ef">KEY</span><span style="color:#960050;background-color:#1e0010">（换句话说，如果联接不能基于关键字选择单个行的话），则使用</span><span style="color:#66d9ef">ref</span><span style="color:#960050;background-color:#1e0010">。如果使用的键仅仅匹配少量行，该联接类型是不错的。</span>

ref可以用于使用<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">或</span><span style="color:#f92672">&lt;=&gt;</span><span style="color:#960050;background-color:#1e0010">操作符的带索引的列。</span>

<span style="color:#960050;background-color:#1e0010">在下面的例子中，</span>MySQL可以使用ref联接来处理ref_tables<span style="color:#960050;background-color:#1e0010">：</span>

<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> ref_table <span style="color:#66d9ef">WHERE</span> key_column<span style="color:#f92672">=</span>expr;

<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> ref_table,other_table
  <span style="color:#66d9ef">WHERE</span> ref_table.key_column<span style="color:#f92672">=</span>other_table.<span style="color:#66d9ef">column</span>;

<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> ref_table,other_table
  <span style="color:#66d9ef">WHERE</span> ref_table.key_column_part1<span style="color:#f92672">=</span>other_table.<span style="color:#66d9ef">column</span>
    <span style="color:#66d9ef">AND</span> ref_table.key_column_part2<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;

<span style="color:#960050;background-color:#1e0010">例如</span>:

mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">drop</span> <span style="color:#66d9ef">index</span> idx_t3_id <span style="color:#66d9ef">on</span> t3;
Query OK, <span style="color:#ae81ff">1000</span> <span style="color:#66d9ef">rows</span> affected (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">03</span> sec)
Records: <span style="color:#ae81ff">1000</span>  Duplicates: <span style="color:#ae81ff">0</span>  Warnings: <span style="color:#ae81ff">0</span>

mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">create</span> <span style="color:#66d9ef">index</span> idx_t3_id <span style="color:#66d9ef">on</span> t3(id) ;
Query OK, <span style="color:#ae81ff">1000</span> <span style="color:#66d9ef">rows</span> affected (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">04</span> sec)
Records: <span style="color:#ae81ff">1000</span>  Duplicates: <span style="color:#ae81ff">0</span>  Warnings: <span style="color:#ae81ff">0</span>

mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t3,t4 <span style="color:#66d9ef">where</span> t3.id<span style="color:#f92672">=</span>t4.accountid;
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+------+-------------------+-----------+---------+----------------------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> select_type <span style="color:#f92672">|</span> <span style="color:#66d9ef">table</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span> <span style="color:#f92672">|</span> possible_keys     <span style="color:#f92672">|</span> <span style="color:#66d9ef">key</span>       <span style="color:#f92672">|</span> key_len <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>                  <span style="color:#f92672">|</span> <span style="color:#66d9ef">rows</span> <span style="color:#f92672">|</span> Extra <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+------+-------------------+-----------+---------+----------------------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">SIMPLE</span>      <span style="color:#f92672">|</span> t4    <span style="color:#f92672">|</span> <span style="color:#66d9ef">ALL</span>  <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>              <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>      <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>                 <span style="color:#f92672">|</span> <span style="color:#ae81ff">1000</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">SIMPLE</span>      <span style="color:#f92672">|</span> t3    <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>  <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> idx_t3_id <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span> dbatest.t4.accountid <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>       <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+------+-------------------+-----------+---------+----------------------+------+-------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">rows</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><h3 id="type-ref_or_null">type-ref_or_null</h3>
<table>
<thead>
<tr>
<th>type 重要的项,显示连接使用的类型,按最 优到最差的类型排序</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ref_or_null</td>
<td>如同 ref, 但是 MySQL 必须在初次查找的结果 里找出 null 条目,然后进行二次查找</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">该联接类型如同</span><span style="color:#66d9ef">ref</span><span style="color:#960050;background-color:#1e0010">，但是添加了</span>MySQL可以专门搜索包含NULL值的行<span style="color:#960050;background-color:#1e0010">。在解决子查询中经常使用该联接类型的优化。</span>

<span style="color:#960050;background-color:#1e0010">在下面的例子中，</span>MySQL可以使用ref_or_null联接来处理ref_tables<span style="color:#960050;background-color:#1e0010">：</span>

<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> ref_table
<span style="color:#66d9ef">WHERE</span> key_column<span style="color:#f92672">=</span>expr <span style="color:#66d9ef">OR</span> key_column <span style="color:#66d9ef">IS</span> <span style="color:#66d9ef">NULL</span>
</code></pre></div><table>
<thead>
<tr>
<th>type 重要的项,显示连接使用的类型,按最 优到最差的类型排序</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>index_merge</td>
<td>说明索引合并优化被使用了</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">该联接类型表示使用了索引合并优化方法。在这种情况下，</span>key列包含了使用的索引的清单<span style="color:#960050;background-color:#1e0010">，</span>key_len包含了使用的索引的最长的关键元素<span style="color:#960050;background-color:#1e0010">。</span>

<span style="color:#960050;background-color:#1e0010">例如</span>:
mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t4 <span style="color:#66d9ef">where</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">3952602</span> <span style="color:#66d9ef">or</span> accountid<span style="color:#f92672">=</span><span style="color:#ae81ff">31754306</span> ;
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+-------------+----------------------------+----------------------------+---------+------+------+------------------------------------------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> select_type <span style="color:#f92672">|</span> <span style="color:#66d9ef">table</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span>        <span style="color:#f92672">|</span> possible_keys              <span style="color:#f92672">|</span> <span style="color:#66d9ef">key</span>                        <span style="color:#f92672">|</span> key_len <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>  <span style="color:#f92672">|</span> <span style="color:#66d9ef">rows</span> <span style="color:#f92672">|</span> Extra                                                <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+-------------+----------------------------+----------------------------+---------+------+------+------------------------------------------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">SIMPLE</span>      <span style="color:#f92672">|</span> t4    <span style="color:#f92672">|</span> index_merge <span style="color:#f92672">|</span> idx_t4_id,idx_t4_accountid <span style="color:#f92672">|</span> idx_t4_id,idx_t4_accountid <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">4</span>     <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span>    <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">Using</span> <span style="color:#66d9ef">union</span>(idx_t4_id,idx_t4_accountid); <span style="color:#66d9ef">Using</span> <span style="color:#66d9ef">where</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+-------------+----------------------------+----------------------------+---------+------+------+------------------------------------------------------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">row</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><h3 id="type-unique_subquery">type-unique_subquery</h3>
<table>
<thead>
<tr>
<th>type 重要的项,显示连接使用的类型,按最 优到最差的类型排序</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>unique_subquery</td>
<td>在某些 IN 查询中使用此种类型,而不是常规的 ref:value IN (SELECT primary_key FROM single_table WHERE some_expr)</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">该类型替换了下面形式的</span>IN子查询的ref<span style="color:#960050;background-color:#1e0010">：</span>

value <span style="color:#66d9ef">IN</span> (<span style="color:#66d9ef">SELECT</span> primary_key <span style="color:#66d9ef">FROM</span> single_table <span style="color:#66d9ef">WHERE</span> some_expr)
unique_subquery是一个索引查找函数<span style="color:#960050;background-color:#1e0010">，可以完全替换子查询，效率更高</span>
</code></pre></div><h3 id="type-index_subquery">type-index_subquery</h3>
<table>
<thead>
<tr>
<th>type 重要的项,显示连接使用的类型,按最 优到最差的类型排序</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>index_subquery</td>
<td>在某些IN查询中使用此种类型,与unique_subquery类似,但是查询的是非唯一性索引: value IN (SELECT key_column FROM single_table WHERE some_expr)</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">该联接类型类似于</span>unique_subquery<span style="color:#960050;background-color:#1e0010">。可以替换</span>IN子查询<span style="color:#960050;background-color:#1e0010">，但只适合下列形式的子查询中的非唯一索引：</span>

value <span style="color:#66d9ef">IN</span> (<span style="color:#66d9ef">SELECT</span> key_column <span style="color:#66d9ef">FROM</span> single_table <span style="color:#66d9ef">WHERE</span> some_expr)
</code></pre></div><h3 id="type-range">type-range</h3>
<table>
<thead>
<tr>
<th>type 重要的项,显示连接使用的类型,按最 优到最差的类型排序</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>range</td>
<td>只检索给定范围的行,使用一个索引来选择 行。key 列显示使用了哪个索引。当使用=、 &lt;&gt;、&gt;、&gt;=、&lt;、&lt;=、IS NULL、&lt;=&gt;、BETWEEN 或者 IN 操作符,用常量比较关键字列时,可 以使用 range</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">只检索给定范围的行，使用一个索引来选择行。</span>key列显示使用了哪个索引<span style="color:#960050;background-color:#1e0010">。</span>key_len包含所使用索引的最长关键元素<span style="color:#960050;background-color:#1e0010">。在该类型中</span>ref列为NULL<span style="color:#960050;background-color:#1e0010">。</span>

<span style="color:#960050;background-color:#1e0010">当使用</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">、</span><span style="color:#f92672">&lt;&gt;</span><span style="color:#960050;background-color:#1e0010">、</span><span style="color:#f92672">&gt;</span><span style="color:#960050;background-color:#1e0010">、</span><span style="color:#f92672">&gt;=</span><span style="color:#960050;background-color:#1e0010">、</span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">、</span><span style="color:#f92672">&lt;=</span><span style="color:#960050;background-color:#1e0010">、</span><span style="color:#66d9ef">IS</span> <span style="color:#66d9ef">NULL</span><span style="color:#960050;background-color:#1e0010">、</span><span style="color:#f92672">&lt;=&gt;</span><span style="color:#960050;background-color:#1e0010">、</span>BETWEEN或者IN操作符<span style="color:#960050;background-color:#1e0010">，用常量比较关键字列时，可以使用</span>range

mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> t3 <span style="color:#66d9ef">where</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">3952602</span> <span style="color:#66d9ef">or</span> id<span style="color:#f92672">=</span><span style="color:#ae81ff">3952603</span> ;
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+-------+-------------------+-----------+---------+------+------+-------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> select_type <span style="color:#f92672">|</span> <span style="color:#66d9ef">table</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span>  <span style="color:#f92672">|</span> possible_keys     <span style="color:#f92672">|</span> <span style="color:#66d9ef">key</span>       <span style="color:#f92672">|</span> key_len <span style="color:#f92672">|</span> <span style="color:#66d9ef">ref</span>  <span style="color:#f92672">|</span> <span style="color:#66d9ef">rows</span> <span style="color:#f92672">|</span> Extra       <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+-------+-------------------+-----------+---------+------+------+-------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">SIMPLE</span>      <span style="color:#f92672">|</span> t3    <span style="color:#f92672">|</span> range <span style="color:#f92672">|</span> <span style="color:#66d9ef">PRIMARY</span>,idx_t3_id <span style="color:#f92672">|</span> idx_t3_id <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span>       <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span> <span style="color:#f92672">|</span>    <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">Using</span> <span style="color:#66d9ef">where</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">----+-------------+-------+-------+-------------------+-----------+---------+------+------+-------------+
</span><span style="color:#75715e"></span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">row</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">02</span> sec)

</code></pre></div><h3 id="type-index">type-index</h3>
<table>
<thead>
<tr>
<th>type 重要的项,显示连接使用的类型,按最 优到最差的类型排序</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>index</td>
<td>全表扫描,只是扫描表的时候按照索引次序 进行而不是行。主要优点就是避免了排序, 但是开销仍然非常大按索引次序扫描，先读索引，再读实际的行，结果还是全表扫描，主要优点是避免了排序。因为索引是排好的</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">该联接类型与</span>ALL相同<span style="color:#960050;background-color:#1e0010">，除了只有索引树被扫描。这通常比</span>ALL快<span style="color:#960050;background-color:#1e0010">，因为索引文件通常比数据文件小。</span>

<span style="color:#960050;background-color:#1e0010">当查询只使用作为单索引一部分的列时，</span>MySQL可以使用该联接类型
</code></pre></div><h3 id="type-all">type-all</h3>
<table>
<thead>
<tr>
<th>type 重要的项,显示连接使用的类型,按最 优到最差的类型排序</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>all</td>
<td>最坏的情况,从头到尾全表扫描</td>
</tr>
</tbody>
</table>
<h3 id="type-null">type-null</h3>
<table>
<thead>
<tr>
<th>type 重要的项,显示连接使用的类型,按最 优到最差的类型排序</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>null</td>
<td>优化过程中就已经得到结果，不在访问表或索引</td>
</tr>
</tbody>
</table>
<h2 id="possible_keys">possible_keys</h2>
<table>
<thead>
<tr>
<th>项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>possible_keys</td>
<td>指出 MySQL 能在该表中使用哪些索引有助于 查询。如果为空,说明没有可用的索引</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">possible_keys列指出MySQL能使用哪个索引在该表中找到行<span style="color:#960050;background-color:#1e0010">。注意，该列完全独立于</span>EXPLAIN输出所示的表的次序<span style="color:#960050;background-color:#1e0010">。这意味着在</span>possible_keys中的某些键实际上不能按生成的表次序使用<span style="color:#960050;background-color:#1e0010">。</span>

<span style="color:#960050;background-color:#1e0010">如果该列是</span><span style="color:#66d9ef">NULL</span><span style="color:#960050;background-color:#1e0010">，则没有相关的索引。在这种情况下，可以通过检查</span>WHERE子句看是否它引用某些列或适合索引的列来提高你的查询性能<span style="color:#960050;background-color:#1e0010">。如果是这样，创造一个适当的索引并且再次用</span>EXPLAIN检查查询
</code></pre></div><h2 id="key">key</h2>
<table>
<thead>
<tr>
<th>项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>MySQL 实际从 possible_key 选择使用的索引。 如果为 NULL,则没有使用索引。很少的情况 下,mysql 会选择优化不足的索引。这种情 况下,可以在 SELECT 语句中使用 USE INDEX (indexname)来强制使用一个索引或者用 IGNORE INDEX(indexname)来强制 mysql 忽略索引</td>
</tr>
</tbody>
</table>
<h2 id="key_len">key_len</h2>
<table>
<thead>
<tr>
<th>项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>key_len</td>
<td>使用的索引的长度。在不损失精确性的情况 下,长度越短越好</td>
</tr>
</tbody>
</table>
<h2 id="ref">ref</h2>
<table>
<thead>
<tr>
<th>项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ref</td>
<td>显示索引的哪一列被使用了</td>
</tr>
</tbody>
</table>
<h2 id="rows">rows</h2>
<table>
<thead>
<tr>
<th>项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>rows</td>
<td>mysql 认为必须检查的用来返回请求数据的行数</td>
</tr>
</tbody>
</table>
<h2 id="extra">Extra</h2>
<ul>
<li>该列包含MySQL解决查询的详细信息
<strong>extra 中出现以下 2 项意味着 mysql 根本不能使用索引,效率会受到重大影响。应尽可能对此进行优化</strong></li>
</ul>
<table>
<thead>
<tr>
<th>项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Using filesort</td>
<td>表示 MySQL 会对结果使用一个外部索引排序,而不是从表里按索引次序读到相关内容。可能在内存或者磁盘上进行排序。MySQL 中无法利用索引完成的排序操作称为“文件排序”, <strong>对于没有索引的列进行order by 就会出现filesort</strong></td>
</tr>
<tr>
<td>Using temporary</td>
<td>表示 MySQL 在对查询结果排序时使用临时表。常见于排序 order by 和分组查询 group by, <strong>MySQL 使用临时表来实现 distinct 操作</strong></td>
</tr>
<tr>
<td>Using index</td>
<td>此查询使用了覆盖索引(Covering Index)，即通过索引就能返回结果，无需访问表。若没显示&quot;Using index&quot;表示读取了表数据。</td>
</tr>
<tr>
<td>Using where</td>
<td>表示 MySQL 服务器从存储引擎收到行后再进行“后过滤”（Post-filter）。所谓“后过滤”，就是先读取整行数据，再检查此行是否符合 where 句的条件，符合就留下，不符合便丢弃。因为检查是在读取行后才进行的，所以称为“后过滤”</td>
</tr>
<tr>
<td>Distinct</td>
<td>一旦mysql找到了与行相联合匹配的行，就不再搜索了</td>
</tr>
<tr>
<td>Not exists</td>
<td>mysql优化了LEFT JOIN，一旦它找到了匹配LEFT JOIN标准的行，就不再搜索</td>
</tr>
<tr>
<td>Range checked for each</td>
<td>没有找到理想的索引，因此对于从前面表中来的每一个行组合，mysql检查使用哪个索引，并用它来从表中返回行。这是使用索引的最慢的连接之一</td>
</tr>
</tbody>
</table>
<h1 id="联合查询的优化">联合查询的优化</h1>
<ul>
<li>简单举例子，LEFT JOIN 条件用于确定如何从右表搜索行,左边一定都有,所以右边是我们的关键点,一定需要建立索引</li>
<li>inner join 和 left join 差不多,都需要优化右表。而 right join 需要优化左表</li>
</ul>

    </div>
</section>

    </body>
</html>