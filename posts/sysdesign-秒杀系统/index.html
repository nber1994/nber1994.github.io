<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">

        <title>sysDesign-秒杀系统</title>

        <link rel="stylesheet" href="/css/stylesheet.css">
    </head>
    <body>
        <section id="page-title">
            <h1><a href="/">nber1994</a></h1>
        </section>



<section class="blog-post">
    <h1>sysDesign-秒杀系统</h1>
    <div class="blog-post-subheader">
        January 10, 2019
    </div>
    <div class="blog-post-content">
        <h1 id="sysdesign-秒杀系统">sysDesign-秒杀系统</h1>
<ul>
<li>秒杀系统主要解决两个问题，一个是并发写，一个是并发读</li>
<li>首先需要和常规的电商系统隔离，避免影响正常的业务流程</li>
<li>同时还需要注意系统的高性能，高扩展，高可用，以及数据一致性（减库存）</li>
</ul>
<h2 id="秒杀架构的原则">秒杀架构的原则</h2>
<ul>
<li>请求数据要尽量少</li>
<li>请求数要尽量少</li>
<li>路径要尽量短</li>
<li>依赖要尽量少</li>
<li>不要存在单点</li>
</ul>
<h2 id="实现">实现</h2>
<h3 id="实现动静分离">实现动静分离</h3>
<ul>
<li>所谓动态数据就是指页面输出数据是否和url，浏览者，时间地域等有关系</li>
<li>静态数据是指不变的数据， 静态数据直接上CDN，请求不到后端服务</li>
</ul>
<h3 id="削峰">削峰</h3>
<ul>
<li>排队
<ul>
<li>队列来承接流量的冲击，但是达到队列的处理瓶颈后，会有请求丢失</li>
</ul>
</li>
<li>答题
<ul>
<li>防刷</li>
<li>分散请求</li>
</ul>
</li>
<li>分层过滤
<ul>
<li>从每一层都拦截或者丢弃（当处理能力达到瓶颈时）一部分的流量来进行请求的削峰</li>
</ul>
</li>
</ul>
<h3 id="减库存">减库存</h3>
<ul>
<li>下单减库存
<ul>
<li>很多下单后没有付款，导致其他人不能正常购买</li>
</ul>
</li>
<li>付款减库存
<ul>
<li>下单数多于库存，导致一些付款无法成功</li>
</ul>
</li>
<li>预扣库存 例如库存预留十分钟时间，当真实付款时检查是否过期，如果过期则就去减库存，如果没有库存则付款失败
<ul>
<li>同样会存在作弊行为</li>
</ul>
</li>
</ul>

    </div>
</section>

    </body>
</html>